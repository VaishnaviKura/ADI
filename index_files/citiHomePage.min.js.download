var signonInitialHeight,signonModalHeight,signonBlock=!1;function populateEFDParams(){(new Date).getTimezoneOffset();var e=(new Date).getTimezoneOffset()/60*-1,n=$("#efdBTZ"),i=$("#efdCSR");null!=n&&null!=i&&($("#efdBTZ").val(e),$("#efdCSR").val(screen.width+"x"+screen.height))}function populateClientData(e){populateEFDParams(),e.devicePrint&&(e.devicePrint.value=encode_deviceprint());var l=null;"undefined"==typeof flagvalue?l=!0:(l=flagvalue,console.log("rsa flag value"+flagvalue),0==l&&(e.RSADevicePrint&&(e.RSADevicePrint.value=submitRSADevicePrint()),e.mobileInfoJs&&(e.mobileInfoJs.value=submitmobilegeolocation())))}function submitRSADevicePrint(){add_deviceprint();var e=urlEncode(add_deviceprint());return console.log("encodersa"+e),e}function submitmobilegeolocation(){var e=getGeolocationStruct();console.log("geoLocationJSON"+e);var o=JSON.stringify(JSON.parse(e));return encodeURIComponent(o)}function doSubmit(e){if(signonBlock)return callbackFunction=function(e){doSubmit(e)},!1;var n;if(!signonLock){(new Date).getTimezoneOffset();var i=(new Date).getTimezoneOffset()/60*-1;if($("#efdBTZ").val(i),$("#efdCSR").val(screen.width+"x"+screen.height),e)for(n=e;n&&"FORM"!=n.nodeName;)n=n.parentNode;else n=$("#logInForm")[0];if("jcbol_marketing_citi-savings"==window.savingsPagedef?$(n).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citi-savings" /><input type="hidden" name="mobileOptimize" value="false" />'):"jcbol_marketing_citibank-savings-plus-account"==window.savingsPagedef?$(n).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citibank-savings-plus-account" /><input type="hidden" name="mobileOptimize" value="false" />'):"jcbol_marketing_certificates-of-deposit"==window.CDIRAPagedef?$(n).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_certificates-of-deposit" /><input type="hidden" name="mobileOptimize" value="false" />'):"jcbol_marketing_citi-ira"==window.IRAPagedef?$(n).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citi-ira" /> '):"jcbol_marketing_cdsDeepdrop"==window.CDnextPageDef&&$(n).append('<input type="hidden" name="product_list" value='+window.CDTermValue+' />\t<input type="hidden" name="next_page" value="jfp|jcbol_marketing_cdsDeepdrop" /><input type="hidden" name="mobileOptimize" value="false" />'),populateClientData(n),!signOnUnamePwdError(n))return callbackFunction=function(e){doSubmit(e)},!1;null!=n.ioBlackBox&&"undefined"!=n.ioBlackBox&&setIOBlackBox(n),clearFieldErrorValidation(),signonBlock=!0,jQuery("#logInForm").submit()}}function signOnUnamePwdError(e){var n=e.username,i=!0;return""==n.value&&""==$("#password").val()||""==n.value&&""!=$("#password").val()?(clearFieldErrorValidation(),$("#username,#usernameMasked").addClass("validation-input-danger").focus(),$("#emptyUidError").removeClass("hidden").addClass("show"),$("#username").attr("aria-describedby","emptyUidError"),i=!1):(""!=n.value||n.value.length<3)&&""==$("#password").val()?(clearFieldErrorValidation(),$("#password").addClass("validation-input-danger").focus(),$("#emptyPasswordError").removeClass("hidden").addClass("show"),$("#password").attr("aria-describedby","emptyPasswordError"),i=!1):""!=n.value&&""!=$("#password").val()&&(n.value.length<3?(clearFieldErrorValidation(),$("#username,#usernameMasked").addClass("validation-input-danger").focus(),$("#lessUidChaError").removeClass("hidden").addClass("show"),$("#username").attr("aria-describedby","lessUidChaError"),i=!1):n.value.length>=3&&$("#password").val().length<6&&(clearFieldErrorValidation(),$("#password").addClass("validation-input-danger").focus(),$("#lessPasswordChaError").removeClass("hidden").addClass("show"),$("#password").attr("aria-describedby","lessPasswordChaError"),i=!1)),$("#lessUidChaError").is(":visible")&&$("#emptyUidError").is(":visible")&&jQuery("#username").attr("aria-describedby","emptyUidError lessUidChaError"),$("#emptyPasswordError").is(":visible")&&$("#lessPasswordChaError").is(":visible")&&jQuery("#password").attr("aria-describedby","emptyPasswordError lessPasswordChaError"),adjustHeroHeight($(".signonContainer").height()),signonModalHeight=$("#hpSignonModal .modal-dialog").height(),i}function clearFieldErrorValidation(){return $("#emptyUidError,#emptyPasswordError,#lessUidChaError,#lessPasswordChaError").addClass("hidden"),$("#username").removeClass("validation-input-danger"),$("#logInForm #usernameMasked").removeClass("validation-input-danger"),$("#password").removeClass("validation-input-danger"),!0}function onSelectUser(e){var n=e[e.selectedIndex].value;if("AddUser"==n){var i=$("#cookiedList"),t=$("#rememberUid"),a=$("#cookiedListLabel");i&&t&&"undefined"!=typeof uidInputField?($(uidInputField).insertBefore(i),i.remove(),a.remove(),$(detachedRemChkBoxDesktop).appendTo("#rememberBlockDesktop"),$(detachedRemChkBoxMobile).appendTo("#rememberBlockMobile"),$("input[type='checkbox']").prop("checked",!1),setTimeout(function(){$("#username").focus()},0)):location.href="/JSO/signon/DisplayUsernameSignon.do?username=AddUser"}else"DeleteUser"==n?location.href=contextPath+"/JSO/signon/DeleteUsername.do?JFP_TOKEN="+JFP_CSRF_TOKEN:$("#cookiedList").focus();doMask(),$("#usernameMasked").attr("placeholder",maskedPlaceHolder),$("#usernameMasked").focus()}function insertAfter(e,n){e.parentNode.insertBefore(n,e.nextSibling)}function mask(e){var n=e.value;if(-1!=e.className.indexOf("userMask")){var t="";if(n.length>=7){for(i=2;i<n.length-2;i++)t+="*";return n.substring(0,2)+t+n.substring(n.length-2)}if(n.length>=3){for(i=1;i<n.length-1;i++)t+="*";return n.substring(0,1)+t+n.substring(n.length-1)}return n}}function focusOn(e){var n=e.id.substring(0,e.id.length-"Masked".length),i=document.getElementById(n);e.style.display="none",i.style.display="block",i.focus()}function blurOn(e){var n=e.id+"Masked",i=document.getElementById(n);$("#"+n).attr("placeholder",maskedPlaceHolder),i.value=mask(e),i.style.display="block",e.style.display="none"}function doMask(){var e=$("input[type='text']"),n=e.length;for(i=0;i<n;i++){var t=e[i],a=t.className;if(-1!=t.id.indexOf("Masked"))n+=1;else if(-1!=a.indexOf("Mask"))e[i].onblur=function(e){that=this,blurOn(that)},window["id"+i]=document.createElement("input"),window["id"+i].id=t.id+"Masked",window["id"+i].className=" "+t.className,document.getElementById(t.id).style.display="none",window["id"+i].onfocus=function(e){that=this,focusOn(that)},window["id"+i].type="text",window["id"+i].value=mask(t),insertAfter(t,window["id"+i])}}function OpenInNewTab(e){window.open(e,"_blank").focus()}function displayLable(e){var n=e+"Label";""!=$("#"+e).val()?$("#"+n).removeClass("text-input-label"):$("#"+n).addClass("text-input-label")}function launchPopup(e,n,i){e=e.indexOf("JFP_TOKEN")>0?e:e.indexOf("?")>0?e+"&JFP_TOKEN="+JFP_CSRF_TOKEN:e+"?JFP_TOKEN="+JFP_CSRF_TOKEN;var t=n;"_top"!=n?(n=(n=tv(document.cookie.split("; "),"BV_IDS")).substring(38,48),"sendMsgWindow"==t?(null==chld_win||""==chld_win||chld_win.closed||sendMsgChldWin!=chld_win)&&(chld_win=window.open(e,n,i),sendMsgChldWin=chld_win,sendMessageWindow=chld_win):(chld_win=window.open(e,n,i),sendMsgChldWin=null)):top.location.href=e}function tv(e,n){for(var i=0;i<e.length;i++){var t=e[i].split("=");if(t[0]==n)return t[1]}return""}function initMLC(){var e=$("#cbol-footer-mlc");null!=e&&(isTestDomain()||(e.style.color="#ffffff"),"undefined"!=typeof s&&void 0!==s.hier1&&""!=s.hier1&&(e.innerHTML=s.hier1+"/"+s.pageName.replace(/\+/g," ")),"undefined"!=typeof _server&&(document.getElementById("cbol-footer-server").innerHTML=displayServerName(_server))),"CBOL"==_site&&top!=self&&(top.pageload=!0)}function displayServerName(e){try{for(var n="",i=" ",t=!1,a=e.length,o=0;o<a;o++){i=e.charAt(o),/^\d+$/.test(i)?(n+=i,t=!0):t&&(n+=".",t=!1)}return/[\.]+/g.test(n.charAt(n.length-1))&&(n=n.substring(0,n.length-1)),n}catch(n){return e}}function isTestDomain(){return v=/\.citicorp.com$|\.citicorp.com:[0-9]{4}$|\.citigroup.net$|\.citibankonlineqa.com$|\.nam.nsroot.net$|\localhost$|\localhost:[0-9]{4}$/,v.test(document.domain)}function getCookie(e){for(var n=e+"=",i=document.cookie.split(";"),t=0;t<i.length;t++){for(var a=i[t];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return""}function setCookie(e,n,i){var t=escape(n);document.cookie=e+"="+t+";expires="+i+";path=/"}function calLinkCharLength(e){return $(e).text().length}function truncateOtherAlert(e,n,i,t){var a=n.length,o=calLinkCharLength(e);""!=n&&(a+o>140?(n=n.substring(0,140-o),$("#"+i).html(n),$("#"+t).removeClass("hidden")):$("#"+i).html(n))}function truncateBrowserAlert(e,n,i){var t=i.length,a=calLinkCharLength(e),o=calLinkCharLength(n);""!=i&&(t+a>140?t+o>140&&(i=i.substring(0,140-o),$("#browserAlert").html(i),$("#cmlink_OutdatedBrowserModal").removeClass("hidden")):($("#browserAlert").html(i),$("#cmlink_OutdatedBrowserLnk").removeClass("hidden")))}function passTmplObj(e){$("#alert-template").tmpl(e).appendTo("#alert-block")}function closeAlertBox(e){$(e).closest(".alertSection").remove()}function showFullMsg(e){for(var n=alerts.alertData,i="",t="",a=0;a<n.length;a++){n[a].alertType==e&&(i=n[a].alertMessage,t=n[a].hideText);var o={alertMsg:i,hideLinktext:t}}return o}function hideFullMsg(e){for(var n=alerts.alertData,i="",t="",a=0;a<n.length;a++){n[a].alertType==e&&(i=n[a].alertMessage,t=n[a].showText);var o={alertMsg:i,showLinktext:t}}return o}function truncateMsg(e){return e.length<=130?e:e.substring(0,127)+"..."}function showAlerts(e){var n=showFullMsg(e),i=n.alertMsg+'<a class="hideCTA" id='+e+' tabindex="0">'+n.hideLinktext+"</a>";$("#"+e).hide(),$("#"+e+"-span").html(i)}function hideAlerts(e){var n=hideFullMsg(e),i=truncateMsg(n.alertMsg)+'<a class="showCTA" id='+e+' tabindex="0">'+n.showLinktext+"</a>";$("#"+e).hide(),$("#"+e+"-span").html(i)}function handleOutageAlert(k){var j,c,r,m,q,i,d;for(alert in k.alertData){if(k.alertData[alert].alertType=="outage-alert"){j=k.alertData[alert].startTime;c=k.alertData[alert].endTime}if(k.alertData[alert].alertType=="relevant-alert"){r=k.alertData[alert].startTime;m=k.alertData[alert].endTime}if(k.alertData[alert].alertType=="weather-alert"){q=k.alertData[alert].startTime;i=k.alertData[alert].endTime}}var p=new Date();var h=(p.getTimezoneOffset()/60);var b=5;if(h>b){d=h-b}else{d=b-h}var a=new Date(new Date(j).getTime()+d*3600*1000);var f=new Date(new Date(c).getTime()+d*3600*1000);var g=new Date(new Date().getTime()+d*3600*1000);var l=new Date(new Date(r).getTime()+d*3600*1000);var o=new Date(new Date(m).getTime()+d*3600*1000);var n=new Date(new Date(q).getTime()+d*3600*1000);var e=new Date(new Date(i).getTime()+d*3600*1000);$(".outage-alert-section").hide();$(".relevant-alert-section").hide();$(".weather-alert-section").hide();if(f>a){if(g>=a){$(".outage-alert-section").show()}if(g>=f){$(".outage-alert-section").hide()}}if(o>l){if(g>=l){$(".relevant-alert-section").show()}if(g>=o){$(".relevant-alert-section").hide()}}if(e>n){if(g>=n){$(".weather-alert-section").show()}if(g>=e){$(".weather-alert-section").hide()}}}function handleSignonLink(){window.innerWidth<992?$("#showLoginBtn").css("display","block"):$("#showLoginBtn").css("display","none")}function adjustHeroHeight(e){var n=400+(signonInitialHeight>e?signonInitialHeight-e:e-signonInitialHeight);window.innerWidth>=992&&$(".hero--section .hero-background").css("height",n+"px")}function adjustHeroOnRotation(e,n){if(e>n){var i=400+(e-n)-30;window.innerWidth>=992&&$(".hero--section .hero-background").css("height",i+"px")}}$(document).ready(function(){signonInitialHeight=$(".signonContainer").height(),$("input[type='checkbox']").prop("checked",!1),$("#cookiedList").prop("selectedIndex",0),$("#rememberBlockDesktop,#rememberBlockMobile").on("change","#rememberUid, #rememberUid-mobile",function(e){$(this).is(":checked")?($("div.ui-tooltip-rmid").removeClass("hidden"),$("div.ui-tooltip-rmid").addClass("show"),adjustHeroHeight($(".signonContainer").height()),signonModalHeight=$("#hpSignonModal .modal-dialog").height()):($("div.ui-tooltip-rmid").removeClass("show"),$("div.ui-tooltip-rmid").addClass("hidden"),adjustHeroHeight($(".signonContainer").height()),signonModalHeight=$("#hpSignonModal .modal-dialog").height())}),$("#logInForm").on("focus","#username",function(){$("#usernameLabel").removeClass("text-input-label")}),$("#logInForm").on("blur","#username",function(){displayLable("username")}),$("#password").focus(function(){$("#passwordLabel").removeClass("text-input-label")}),$("#password").blur(function(){displayLable("password")}),$("#logInForm").on("focus","#cookiedList",function(){$("#cookiedListLabel").removeClass("text-input-label")}),$("#logInForm").on("blur","#cookiedList",function(){displayLable("cookiedList")}),$("#alert-block").length>0&&(handleSignonLink(),$(window).resize(function(){handleSignonLink()}));var e=!1;$("#showLoginBtn").on("click",function(){1==e?(jQuery(".signonDivTrans").addClass("signonContainer"),jQuery(".signonContainer").removeClass("signonDivTrans"),e=!1,$("#showLoginBtn span").removeClass("expanded")):(jQuery(".signonContainer").addClass("signonDivTrans"),jQuery(".signonContainer").removeClass("signonContainer"),e=!0,$("#showLoginBtn span").addClass("expanded"))}),$("#logInForm").on("keydown",function(e){13==e.keyCode&&("false"==message&&checkTMXProfiling(),e.preventDefault(),doSubmit())}),$(".signOnBtn").on("click",function(e){e.preventDefault(),$("#hpSignonModal").modal(),setTimeout(function(){$("#hpSignonModal #usernameMasked").focus()},500)}),window.innerWidth<992&&($(".signonContainer #logInForm").appendTo("#hpSignonModal .inputGroup"),$("#hpSignonModal").on("hidden.bs.modal",function(){clearFieldErrorValidation(),$("#username").val(""),$("#usernameMasked").val(""),$("#password").val("")})),$(window).resize(function(){window.innerWidth>=992?($("#hpSignonModal").modal("hide"),$("#hpSignonModal #logInForm").appendTo(".signonContainer .sign-on-form"),adjustHeroOnRotation(signonModalHeight,signonInitialHeight),signonInitialHeight=375,adjustHeroHeight(423)):window.innerWidth<992&&$(".signonContainer #logInForm").appendTo("#hpSignonModal .inputGroup")}),$("#hpSignonModal").on("hidden.bs.modal",function(){clearFieldErrorValidation(),$("#username").val(""),$("#usernameMasked").val(""),$("#password").val(""),$(":checked").attr("checked",!1),$(".ui-tooltip-rmid").addClass("hidden").removeClass("show")}),0!=$("#signOnLoginError").length&&(signonInitialHeight=375,setTimeout(function(){adjustHeroHeight($(".signonContainer").height())},1200))}),window.onload=function(){""==$("#signOnLoginError").text()&&null==$("#signOnLoginError").text()||($("span#signOnLoginError").focus(),$("span#signOnLoginError").on("keydown",function(e){9==(e.keyCode||e.which)&&(e.preventDefault(),e.shiftKey?$("ul.pull-right li:nth-child(1) a").focus():$("input#usernameMasked").focus())}))};
